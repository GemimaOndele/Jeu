console.log('Jeu démarré');

let box = document.querySelector('.box');
console.log(box);
let click = 0;
let scoreElement = document.querySelector('#score');

let chrono = 30;
let chronoElement = document.querySelector('#chrono');
chronoElement.innerHTML = ("0" + chrono).slice(-2);

// Récupération des scores depuis localStorage
let bestScore = localStorage.getItem('bestScore') || 0;
let previousScore = localStorage.getItem('previousScore') || 0;

// Affichage des scores précédents et meilleur score
scoreElement.innerHTML = `Score précédent: ${previousScore}<br>Meilleur score: ${bestScore}<br>Score actuel: ${click}`;

// Fonction pour mettre à jour le score
function updateScore() {
  click++;
  scoreElement.innerHTML = `Score précédent: ${previousScore}<br>Meilleur score: ${bestScore}<br>Score actuel: ${click}`;
  if (click > bestScore) {
    bestScore = click;
    localStorage.setItem('bestScore', bestScore);
  }
  localStorage.setItem('previousScore', click);
}

// Fonction pour remettre à zéro le score
function resetScore() {
  click = 0;
  previousScore = localStorage.getItem('previousScore') || 0;
  localStorage.setItem('previousScore', previousScore);
  scoreElement.innerHTML = `Score précédent: ${previousScore}<br>Meilleur score: ${bestScore}<br>Score actuel: ${click}`;
}

// Fonction pour faire bouger la boîte de manière aléatoire
function moveBox() {
  let top = Math.floor(Math.random() * (window.innerHeight - box.clientHeight));
  let left = Math.floor(Math.random() * (window.innerWidth - box.clientWidth));
  box.style.top = `${top}px`;
  box.style.left = `${left}px`;
}

// Initialisation des variables
box.style.position = 'absolute';
box.style.cursor = 'pointer';
box.style.transition = 'top 0.5s, left 0.5s';
moveBox();

// Lancement du chrono
let timer = setInterval(() => {
  if (chrono > 0) {
    chrono--;
    chronoElement.innerHTML = ("0" + chrono).slice(-2);
  } else {
    clearInterval(timer);
    alert(`Temps écoulé ! Votre score est de ${click}`);
    resetScore();
    chrono = 30;
    chronoElement.innerHTML = ("0" + chrono).slice(-2);
    moveBox();
  }
}, 1000);

// options sur les événements pour le clic sur la boîte
box.addEventListener("click", () => {
  updateScore();
  moveBox();
});
